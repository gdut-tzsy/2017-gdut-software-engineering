<%@page import="org.apache.struts2.components.Include"%>
<%@page language="java" contentType="text/html; charset=UTF-8" %>
<%@ page import="cn.com.do1.dqdp.core.DqdpAppContext" %>
<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">    
<%@include file="/jsp/common/dqdp_common_dgu.jsp" %>
    <head>
        <meta charset="utf-8">
        <title>道一企微开通申请</title>
        <meta name="description" content="">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <meta content="telephone=no" name="format-detection" />
        <meta content="email=no" name="format-detection" />
        <link rel="stylesheet" href="${baseURL}/jsp/wap/css/ku.css?ver=<%=jsVer%>" />
        <link rel="stylesheet" href="${baseURL}/jsp/wap/css/font-awesome.min.css?ver=<%=jsVer%>" />
        <script type="text/javascript" src="${baseURL}/jsp/wap/js/zepto.min.js"></script>
        <script type="text/javascript" src="${baseURL}/jsp/wap/js/detect.js"></script>
        <script type="text/javascript" src="${baseURL}/jsp/wap/js/flipsnap.js"></script>
        <script type="text/javascript" src="${baseURL}/jsp/wap/js/wechat.js"></script>
        <script type="text/javascript" src="${baseURL}/jsp/wap/js/emojify.min.js"></script>
        <script type="text/javascript" src="${baseURL}/jsp/wap/js/ku.js?ver=<%=jsVer%>"></script>
        <script type="text/javascript" src="${baseURL}/jsp/wap/js/main.js?ver=<%=jsVer%>"></script>
		<script type="text/javascript" src="js/jquery-1.10.2.min.js"></script>
		<script src='${baseURL}/jsp/wap/js/common.js?ver=<%=jsVer%>'></script>
		<script src="${baseURL}/jsp/wap/js/zepto.form.js"></script>
		
	    <!--组件依赖css begin-->
	    <link rel="stylesheet" type="text/css" href="${baseURL}/jsp/wap/demo/calendar/assets/calendar.css" />
	    <!--组件依赖css end-->
	
	   
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
<body>
			<div style="background-color: #32CD32;height:50px;text-align:center;vertical-align:middle;">
				<h3 style="padding-top:15px;"><font color='#FFFFFF'>道一企微产品开通申请表<font></font></h3>
			</div> 
			<div id="wrap_main" class="wrap">
  				 <div id="main" class="wrap_inner">
            	<form  id="form" onsubmit="return false;">
                <div class="form-style">
					<div class="f-item ">
                        <div class="inner-f-item item-text flexbox" style="height:26px;margin-top:-8px"><span >请填写您企业的名称，以及联系人信息。感谢您关注道一企业微信产品。</span>
                        </div> 
                    </div>
                	<div class="f-item ">
                        <div class="inner-f-item item-text flexbox"><span class="f-item-title">企业名称<font color='red'>*</font></span>
	                        <div class="flexItem">
                        		<input class="item-select inputStyle" name="tbQyExperienceApplicationPO.enterpriseName" id="cnname" placeholder="请输入您的企业名称"  />
                        	</div>
                        </div> 
                    </div>
                    <div class="f-item">
                    	<div class="inner-f-item item-text flexbox">
	                        <span class="f-item-title">企业规模<font color='red'>*</font></span>
	                       	<div class="flexItem">
		                      <select id="select" name="tbQyExperienceApplicationPO.staffNumber" class="flexItem item-select" style="margin-left:-2PX;">
								  <option value="1">请选择企业员工规模</option>
								  <option value="2">0~10人</option>
								  <option value="3">11~50人</option>
								  <option value="4">51~100人</option>
								  <option value="5">101~200人</option>
								  <option value="6">201~500人</option>
								  <option value="7">500人以上</option>					  					  
							  </select>
	                       </div>
                        </div>
                    </div>
                    <div class="f-item">
                    	<div class="inner-f-item item-text flexbox"> 
		                    <span class="f-item-title">所在省份</span>
		                    <div class="flexItem">
			                    <select id="selectpro" name="tbQyExperienceApplicationPO.province" class="flexItem item-select" style="margin-left:3PX;">
			                    <option value="">请选择省份</option>
								<option value="北京">北京</option>
								<option value="广东">广东</option><option value="湖北">湖北</option><option value="湖南">湖南</option>
								<option value="广西">广西</option><option value="福建">福建</option><option value="安徽">安徽</option>
								<option value="云南">云南</option><option value="四川">四川</option><option value="贵州">贵州</option>
								<option value="澳门">澳门</option><option value="香港">香港</option><option value="台湾">台湾</option>
								<option value="江西">江西</option><option value="浙江">浙江</option><option value="江苏">江苏</option>
								<option value="河南">河南</option><option value="河北">河北</option><option value="山东">山东</option>
								<option value="山西">山西</option><option value="陕西">陕西</option><option value="甘肃">甘肃</option>
								<option value="青海">青海</option><option value="宁夏">宁夏</option><option value="辽宁">辽宁</option>
								<option value="新疆">新疆</option><option value="西藏">西藏</option><option value="海南">海南</option>
								<option value="吉林">吉林</option><option value="黑龙江">黑龙江</option><option value="内蒙古">内蒙古</option>
								<option value="天津">天津</option><option value="上海">上海</option>
								<option value="重庆">重庆</option>
								</select>
	                      </div>
                        </div>
                    </div>
                    <div class="f-item">
                        <div class="inner-f-item item-text flexbox"><span class="f-item-title">联&nbsp;&nbsp;系&nbsp;&nbsp;人<font color='red'>*</font></span>
                            <div class="flexItem">
                            	<input type="" name="tbQyExperienceApplicationPO.contactName" value="" id="name" placeholder="请输入联系人姓名" class="item-select inputStyle" />
                            </div>
                        </div>
                    </div>
                    <div class="f-item">
                        <div class="inner-f-item item-text flexbox"><span class="f-item-title">手机号码<font color='red'>*</font></span>
                            <div class="flexItem">
                            	<input type="" name="tbQyExperienceApplicationPO.tel" value="" id="sj" placeholder="请输入联系手机" class="item-select inputStyle" />
                            </div>
                        </div>
                    </div>
                    <div class="f-item">
                        <div class="inner-f-item item-text flexbox"><span class="f-item-title">E-Mail<font color='red'>*</font></span>
                            <div class="flexItem">
                            	<input type="" name="tbQyExperienceApplicationPO.email" value="" id="email" placeholder="请填写常用邮箱地址" class="item-select inputStyle" />
                            </div>
                        </div>
                    </div>
                    <div class="f-item">
                        <div class="inner-f-item item-text flexbox"><span class="f-item-title">微&nbsp;&nbsp;信&nbsp;&nbsp;号</span>
                            <div class="flexItem">
                            	<input type="" name="tbQyExperienceApplicationPO.weixin" value=""  placeholder="请填写微信号" class="item-select inputStyle" />
                            </div>
                        </div>
                    </div>
                    
                   
                    <div class="form_btns mt10">
                        <div class="inner_form_btns">
                            <div class="fbtns flexbox"> 
                            	<input type="hidden" value="0" name="phonetype"/>
                            	<a class="fbtn btn flexItem" id="submita" href="javascript:addApplication()" style="display:block">提交申请</a>
                            	<a class="fbtn btn flexItem" id="submitb" style="display:none">提交申请</a>
                            </div>
                        </div>
                    </div>
                    <div class="fbtns_desc">已经申请了企业微信的企业，请通过电脑在 http://wbg.do1.com.cn/ 申请免费接入企微应用。</div>
                </div>
             </form>
            </div>
</div>
	 <%@include file="/jsp/wap/include/showMsg.jsp"%>
</body>
   <script>
	var isPass="0";
		$(function(){
		
					   dataForWeixin.url=window.location.href;
					   dataForWeixin.title="道一企微产品开通申请表";
					   dataForWeixin.desc="请填写您企业的名称，以及联系人信息。感谢您关注道一企业微信产品。";
					   dataForWeixin.MsgImg="http://wx.qlogo.cn/mmhead/Q3auHgzwzM5PiaLhMITIwJdSuic6skG1UnRAMtxeC2HMxXtMYIeRjtxA/0";
					   dataForWeixin.TLImg="http://wx.qlogo.cn/mmhead/Q3auHgzwzM5PiaLhMITIwJdSuic6skG1UnRAMtxeC2HMxXtMYIeRjtxA/0";
					   dataForWeixin.fakeid="do1";
					
 
			$(window).resize(function(){
				if($(window).height() < 800){
					$('.footer').css('position','relative');
				}else {
					$('.footer').css('position','fixed');
				}
			})
			
		});
		
		$(function(){
			if($(window).height( )< 650){
				$('.footer').css('position','relative');
			}else{
				$(window).resize(function(){
						if($(window).height() < 800){
							$('.footer').css('position','relative');
						}else {
							$('.footer').css('position','fixed');
						}
					})
			}
		});
	$("#email").blur(function(){
		check();
	});
	$("#sj").blur(function(){
		check();
	});
	$("#cnname").blur(function(){
		var name=$('#cnname').val();
   		$.ajax({
   			url:"${baseURL}/portal/experienceapplication/expappAction!checkOrgName.action",
   			type:"POST",
   			data:{name:name},
   			dataType:'json',
   			async:false,
   			success:function (result) {
   				if(result.code=="2"){
   					showMsg("","企业名称已存在,请联系管理员",1);
   				}else{
   					isPass="1";
   				}
   			}
   		});
	});
	function check(){		//验证邮箱格式、手机格式
	   var email=$("#email").val();
	   var sj=$("#sj").val();
	   if(!/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/.test(email) && email!=""){
		   showMsg("","请输入正确的邮箱",1);
		   return ;
	   }
	   if(!/^\d+$/.test(sj) && sj!=""){
		   showMsg("","请输入正确的手机号码",1);
		   return ;
	   }
	}
	function addApplication() {
		$("#submita").hide();
		$("#submitb").show();
		if(isPass=="0"){
			showMsg("","企业名称已存在,请联系管理员",1);
			$("#submitb").hide();
	  		$("#submita").show();
		    return ;
		}
		if($("#cnname").val()==""){
			showMsg("","请输入企业名称",1);
			$("#submitb").hide();
			$("#submita").show();
			return ;
		}
		if($("#select").val()=='1'){
			showMsg("","请选择企业规模！",1);
			$("#submitb").hide();
			$("#submita").show();
			return ;
		}
		if($("#email").val()==""){
			showMsg("","请输入邮箱！",1);
			$("#submitb").hide();
			$("#submita").show();
			return ;
			//$("#email").val("未填写");
		}
		if($("#name").val()==""){
			showMsg("","请输入联系人！",1);
			$("#submitb").hide();
			$("#submita").show();
			return ;
		}
		if($("#sj").val()==""){
			showMsg("","请输入手机号码！",1);
			$("#submitb").hide();
			$("#submita").show();
			return ;
		}
    	$.ajax({
    		url:"${baseURL}/portal/experienceapplication/expappAction!ajaxAdd.action",
    		type:"POST",
    		data:$("#form").serialize(),
    		dataType:"json",
    		success:function(result){
    			if(result.code=="0"){
    				//alert("你已经成功提交申请，我们将会尽快审核并与你联系。");
    				//showMsg("","感谢你的支持，你已经成功提交申请，我们会尽快开通账号发送到登记的邮箱，请留意查收。",1);
    				showMsg("","感谢你的支持，你已经成功提交申请，请使用电脑登录填写的邮箱进行下一步操作。",1);
					//清空表单数据
    				$(':input','#form')
    				 .not(':button, :submit, :reset, :hidden')
    				 .val('')
    				 .removeAttr('checked')
    				 .removeAttr('selected');
    			}else if(result.code=="1888"){
    				showMsg("","提交过于频繁，请稍后再试！",1);
    			}else{
    				showMsg("","系统繁忙",1);
    			}
    			$("#email").val("");
    			$("#submitb").hide();
    			$("#submita").show();
    		},
    		error:function(){
    			$("#submitb").hide();
    			$("#submita").show();
    			hideLoading();
    			showMsg("",result.desc,1);
    		}
    	}); 
	}
    </script>
</html>